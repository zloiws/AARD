# ✅ Исправление двойного запроса

## Проблема

При отправке сообщения отправлялось два запроса:
1. **Первый запрос** - через JavaScript `fetch()` с правильными параметрами (`server_id`, `model`)
2. **Второй запрос** - через HTMX (`hx-post`) без параметров (`server_id=None, model=None`)

Второй запрос автоматически выбирал первую модель по приоритету (`huihui_ai/gemma3-abliterated:4b-q8_0`), что создавало путаницу.

## Причина

В форме были одновременно:
- `hx-post="/api/chat/"` - HTMX отправляет запрос
- `onsubmit="return handleSubmit(event)"` - JavaScript отправляет запрос через `fetch()`

Оба механизма срабатывали, создавая двойной запрос.

## Решение

Убраны HTMX атрибуты из формы:
- Удалено `hx-post="/api/chat/"`
- Удалено `hx-target="#messages"`
- Удалено `hx-swap="beforeend"`
- Удалено `hx-indicator="#loading"`
- Удалено `hx-trigger="submit"`
- Удалено `hx-ext="json-enc"`

Теперь используется только JavaScript `handleSubmit()` с `fetch()`, который:
- Правильно передает `server_id` и `model`
- Обрабатывает ответ и вставляет его в DOM
- Показывает ошибки при необходимости

## Результат

Теперь отправляется только один запрос с правильными параметрами:
- `server_id` - выбранный сервер
- `model` - выбранная модель
- `task_type` - тип задачи
- `temperature` - температура

## Проверка

После исправления:
1. Отправьте сообщение
2. Проверьте логи сервера - должен быть только один запрос
3. В логах должно быть: `server_id=..., model=...` (не `None`)

