<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="1" skipped="2" tests="29" time="15.672" timestamp="2025-12-22T14:37:43.023454" hostname="zloiws"><testcase classname="" name="tests.integration.test_planning_api" time="0.000"><skipped message="collection skipped">('C:\\work\\AARD\\backend\\tests\\integration\\test_planning_api.py', 15, 'Skipped: Skipping planning API integration tests (require running server). Set RUN_API_INTEGRATION_TESTS=1 to enable.')</skipped></testcase><testcase classname="tests.integration.test_planning_api_simple" name="test_health" time="0.001" /><testcase classname="tests.integration.test_planning_api_simple" name="test_list_plans" time="0.002" /><testcase classname="tests.integration.test_planning_api_simple" name="test_get_plan" time="0.001" /><testcase classname="tests.integration.test_planning_api_simple" name="test_get_plan_status" time="0.001" /><testcase classname="tests.integration.test_planning_api_simple" name="test_filter_plans" time="0.001" /><testcase classname="tests.integration.test_planning_digital_twin.Test1SimpleTaskPlanning" name="test_create_simple_task_and_plan" time="0.579" /><testcase classname="tests.integration.test_planning_digital_twin.Test2DigitalTwinContext" name="test_digital_twin_context_creation" time="0.161" /><testcase classname="tests.integration.test_planning_digital_twin.Test3ContextReuse" name="test_planning_with_previous_context" time="0.329" /><testcase classname="tests.integration.test_planning_digital_twin.Test4ComplexTask" name="test_complex_task_planning" time="0.195"><failure message="AssertionError: assert 1 &gt; 3&#10; +  where 1 = len([{'agent': None, 'approval_required': False, 'dependencies': [], 'description': 'Create a complete e-commerce application with:\n        1. User authentication and authorization\n        2. Product catalog with categories\n        3. Shopping cart functionality\n        4. Order processing\n        5. Payment integration\n        6. Admin dashboard\n        7. Email notifications\n        8. Search functionality', ...}])&#10; +    where [{'agent': None, 'approval_required': False, 'dependencies': [], 'description': 'Create a complete e-commerce application with:\n        1. User authentication and authorization\n        2. Product catalog with categories\n        3. Shopping cart functionality\n        4. Order processing\n        5. Payment integration\n        6. Admin dashboard\n        7. Email notifications\n        8. Search functionality', ...}] = &lt;Plan(id=e554bede-b4e1-4bdf-b3ff-3ca9be48993b, task_id=745db23f-5297-4623-a4f6-748f5c955ce5, version=1, status=draft)&gt;.steps">self = &lt;tests.integration.test_planning_digital_twin.Test4ComplexTask object at 0x000002ABE711EE10&gt;
db = &lt;sqlalchemy.orm.session.Session object at 0x000002ABE961EE40&gt;
planning_service = &lt;app.services.planning_service.PlanningService object at 0x000002ABE9635220&gt;

    @pytest.mark.asyncio
    async def test_complex_task_planning(self, db, planning_service):
        """Test planning a complex task that should generate many steps"""
    
        task_description = """Create a complete e-commerce application with:
        1. User authentication and authorization
        2. Product catalog with categories
        3. Shopping cart functionality
        4. Order processing
        5. Payment integration
        6. Admin dashboard
        7. Email notifications
        8. Search functionality"""
    
        plan = await planning_service.generate_plan(
            task_description=task_description,
            context=None
        )
    
        # Verify plan was created
        assert plan is not None
&gt;       assert len(plan.steps) &gt; 3  # Complex task should have many steps
E       AssertionError: assert 1 &gt; 3
E        +  where 1 = len([{'agent': None, 'approval_required': False, 'dependencies': [], 'description': 'Create a complete e-commerce application with:\n        1. User authentication and authorization\n        2. Product catalog with categories\n        3. Shopping cart functionality\n        4. Order processing\n        5. Payment integration\n        6. Admin dashboard\n        7. Email notifications\n        8. Search functionality', ...}])
E        +    where [{'agent': None, 'approval_required': False, 'dependencies': [], 'description': 'Create a complete e-commerce application with:\n        1. User authentication and authorization\n        2. Product catalog with categories\n        3. Shopping cart functionality\n        4. Order processing\n        5. Payment integration\n        6. Admin dashboard\n        7. Email notifications\n        8. Search functionality', ...}] = &lt;Plan(id=e554bede-b4e1-4bdf-b3ff-3ca9be48993b, task_id=745db23f-5297-4623-a4f6-748f5c955ce5, version=1, status=draft)&gt;.steps

..\tests\integration\test_planning_digital_twin.py:209: AssertionError</failure></testcase><testcase classname="tests.integration.test_planning_digital_twin.Test5ReplanningWithErrors" name="test_replanning_with_execution_errors" time="0.402" /><testcase classname="tests.integration.test_planning_metrics" name="test_calculate_plan_quality_score" time="0.738" /><testcase classname="tests.integration.test_planning_metrics" name="test_calculate_plan_quality_score_optimal_steps" time="0.762" /><testcase classname="tests.integration.test_planning_metrics" name="test_track_plan_execution_success" time="1.084" /><testcase classname="tests.integration.test_planning_metrics" name="test_track_plan_execution_failure" time="0.828" /><testcase classname="tests.integration.test_planning_metrics" name="test_get_planning_statistics" time="0.715" /><testcase classname="tests.integration.test_planning_metrics" name="test_get_plan_quality_breakdown" time="0.774" /><testcase classname="tests.integration.test_planning_metrics" name="test_get_plan_quality_breakdown_with_execution" time="0.765" /><testcase classname="tests.integration.test_planning_system_complete.TestPlanningSystemComplete" name="test_error_detection_and_auto_replan" time="0.012" /><testcase classname="tests.integration.test_planning_system_complete.TestPlanningSystemComplete" name="test_plan_visualization_with_tree" time="0.027" /><testcase classname="tests.integration.test_planning_system_complete.TestPlanningSystemComplete" name="test_complete_workflow" time="0.001" /><testcase classname="tests.integration.test_planning_with_dialogs" name="test_planning_simple_task_no_dialog" time="0.953" /><testcase classname="tests.integration.test_planning_with_dialogs" name="test_planning_complex_task_with_dialog" time="1.098" /><testcase classname="tests.integration.test_planning_with_dialogs" name="test_planning_with_explicit_dialog_requirement" time="1.082" /><testcase classname="tests.integration.test_planning_with_dialogs" name="test_dialog_context_in_plan" time="1.084" /><testcase classname="tests.integration.test_planning_with_dialogs_real_llm" name="test_planning_complex_task_with_real_dialog_llm" time="0.846"><skipped type="pytest.skip" message="Нет активных серверов">C:\work\AARD\backend\tests\integration\test_planning_with_dialogs_real_llm.py:48: Нет активных серверов</skipped></testcase><testcase classname="tests.integration.test_planning_with_prompts.TestPlanningWithPrompts" name="test_planning_service_uses_prompts_from_db" time="0.238" /><testcase classname="tests.integration.test_planning_with_prompts.TestPlanningWithPrompts" name="test_planning_service_fallback_to_default" time="0.623" /><testcase classname="tests.integration.test_planning_with_prompts.TestPlanningWithPrompts" name="test_prompt_usage_tracking" time="0.764" /></testsuite></testsuites>