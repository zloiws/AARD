<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="1" time="1.716" timestamp="2025-12-21T22:20:38.588682" hostname="zloiws"><testcase classname="tests.integration.test_prompt_auto_improvement" name="test_analyze_and_improve_prompts_low_success_rate" time="0.830"><failure message="NameError: name 'PromptUsage' is not defined">db = &lt;sqlalchemy.orm.session.Session object at 0x00000266570B3E30&gt;

    @pytest.mark.asyncio
    async def test_analyze_and_improve_prompts_low_success_rate(db):
        """Test automatic improvement when success rate is low"""
        context = ExecutionContext.from_db_session(db)
        manager = PromptManager(context)
    
        # Create a prompt with low success rate
        from app.services.prompt_service import PromptService
    
        prompt_service = PromptService(db)
        test_prompt = prompt_service.create_prompt(
            name="test_low_success",
            prompt_text="Test prompt",
            prompt_type=PromptType.SYSTEM,
            level=0
        )
    
        # Set low success rate
        test_prompt.success_rate = 0.3
        db.commit()
    
        # Add usage tracking
        manager._usage_tracking = [
&gt;           PromptUsage(test_prompt.id, "planning", 1000.0, False, 50.0)
        ]
E       NameError: name 'PromptUsage' is not defined

backend\tests\integration\test_prompt_auto_improvement.py:36: NameError</failure></testcase></testsuite></testsuites>