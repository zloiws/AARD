# Изменения: Ручной выбор модели

## Проблема

Система автоматически выбирала модели на основе типа задачи, но:
1. Модели могли быть недоступны
2. Не было возможности явно выбрать конкретную модель
3. Статус доступности моделей не отображался

## Решение

### 1. Ручной выбор модели в UI

Добавлен выпадающий список "Модель" в интерфейсе:
- Опция "Автоматический выбор" - система выбирает модель по типу задачи
- Список всех доступных моделей с индикаторами статуса
- ✓ (доступна) / ✗ (недоступна)

### 2. Отображение статуса моделей

- При загрузке страницы проверяется доступность каждой модели
- В шапке отображается: "Модели: X/Y доступны"
- В списке моделей показаны все модели с их статусом

### 3. Логика выбора

**Если выбрана конкретная модель:**
- Используется выбранная модель
- Если модель недоступна, показывается предупреждение
- При недоступности - возвращается ошибка (пользователь видит, что модель недоступна)

**Если выбрано "Автоматический выбор":**
- Система выбирает модель на основе типа задачи
- Если предпочтительная модель недоступна:
  - Пытается найти другую подходящую модель
  - В крайнем случае использует первый доступный инстанс

### 4. Улучшенная обработка ошибок

- Предупреждение при выборе недоступной модели
- Fallback на доступные модели при автоматическом выборе
- Понятные сообщения об ошибках

## Использование

### В интерфейсе:

1. Откройте главную страницу `http://localhost:8000/`
2. В выпадающем списке "Модель" выберите:
   - "Автоматический выбор" - для автоматического подбора
   - Конкретную модель - для явного выбора
3. Статус доступности отображается рядом с названием модели

### Через API:

```json
POST /api/chat/
{
  "message": "Напиши функцию",
  "model": "qwen3-coder:30b-a3b-q4_K_M",  // Явный выбор
  "task_type": "code_generation"
}
```

Или без указания модели (автоматический выбор):
```json
{
  "message": "Напиши функцию",
  "task_type": "code_generation"  // model не указан = автоматический выбор
}
```

## Измененные файлы

- `backend/app/api/routes/pages.py` - добавлена проверка статуса моделей
- `backend/app/api/routes/chat.py` - обработка пустого значения model
- `backend/app/core/ollama_client.py` - улучшен fallback при автоматическом выборе
- `frontend/templates/index.html` - добавлен выбор модели в UI
- `docs/WEB_INTERFACE.md` - обновлена документация

## Примеры

### Пример 1: Явный выбор доступной модели
```
Модель: qwen3-coder:30b-a3b-q4_K_M (✓ доступна)
Тип задачи: Генерация кода
→ Используется выбранная модель
```

### Пример 2: Явный выбор недоступной модели
```
Модель: qwen3-coder:30b-a3b-q4_K_M (✗ недоступна)
→ Показывается предупреждение
→ При отправке - ошибка с понятным сообщением
```

### Пример 3: Автоматический выбор
```
Модель: Автоматический выбор
Тип задачи: Генерация кода
→ Система выбирает qwen3-coder (предпочтительная для code_generation)
→ Если недоступна - выбирает другую доступную модель
```

