# üìã –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

## –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–ª–∞–Ω–æ–≤ —á–µ—Ä–µ–∑ LLM, —Ä–∞–∑–±–∏–µ–Ω–∏–µ–º –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

## –ß—Ç–æ —É–∂–µ –µ—Å—Ç—å

‚úÖ **–ú–æ–¥–µ–ª—å Plan –≤ –ë–î:**
- `backend/app/models/plan.py` - –º–æ–¥–µ–ª—å –ø–ª–∞–Ω–∞
- –¢–∞–±–ª–∏—Ü–∞ `plans` –≤ –ë–î (—Å–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–µ–π 003)
- –ü–æ–ª—è: goal, strategy, steps, alternatives, status, current_step

‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `backend/app/planning/` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å

### 1. –°–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (`backend/app/services/planning_service.py`)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–ª–∞–Ω–∞ —á–µ—Ä–µ–∑ LLM
- –†–∞–∑–±–∏–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —à–∞–≥–æ–≤
- –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –≤ –ë–î

**–ú–µ—Ç–æ–¥—ã:**
```python
class PlanningService:
    async def generate_plan(task_description: str) -> Plan
    async def decompose_task(task: str) -> List[Dict]
    async def create_plan_steps(goal: str, context: Dict) -> List[Dict]
    async def assess_risks(plan: Plan) -> Dict
    async def create_alternatives(plan: Plan) -> List[Dict]
    async def save_plan(plan_data: Dict) -> Plan
    async def get_plan(plan_id: UUID) -> Plan
    async def update_plan_status(plan_id: UUID, status: PlanStatus)
    async def replan(plan_id: UUID, reason: str) -> Plan
```

### 2. API endpoints (`backend/app/api/routes/plans.py`)

**Endpoints:**
- `POST /api/plans/` - —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
- `GET /api/plans/` - —Å–ø–∏—Å–æ–∫ –ø–ª–∞–Ω–æ–≤
- `GET /api/plans/{plan_id}` - –¥–µ—Ç–∞–ª–∏ –ø–ª–∞–Ω–∞
- `PUT /api/plans/{plan_id}` - –æ–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω
- `POST /api/plans/{plan_id}/approve` - —É—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–ª–∞–Ω
- `POST /api/plans/{plan_id}/execute` - –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- `POST /api/plans/{plan_id}/replan` - –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
- `GET /api/plans/{plan_id}/status` - —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `frontend/templates/plans/list.html` - —Å–ø–∏—Å–æ–∫ –ø–ª–∞–Ω–æ–≤
- `frontend/templates/plans/detail.html` - –¥–µ—Ç–∞–ª–∏ –ø–ª–∞–Ω–∞
- `frontend/templates/plans/create.html` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞ (–¥–µ—Ä–µ–≤–æ —à–∞–≥–æ–≤)
- –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –†—É—á–Ω–æ–µ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:**
- `huihui_ai/deepseek-r1-abliterated:8b` - –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (reasoning, planning)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

**–ü—Ä–æ–º–ø—Ç—ã:**
- –ü—Ä–æ–º–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–¥–∞—á–∏
- –ü—Ä–æ–º–ø—Ç –¥–ª—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–æ–º–ø—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤
- –ü—Ä–æ–º–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∞ (–ø–æ –¢–ó)

```yaml
plan:
  goal: "–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ–π —Ü–µ–ª–∏"
  strategy:
    approach: "–û–±—â–∏–π –ø–æ–¥—Ö–æ–¥"
    assumptions: ["–ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ 1"]
    constraints: ["–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1"]
    success_criteria: ["–ö—Ä–∏—Ç–µ—Ä–∏–π 1"]
  steps:
    - step_id: "step_1"
      description: "–û–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–∞"
      type: "action|decision|validation|approval"
      agent: "agent_id –∏–ª–∏ null"
      tool: "tool_id –∏–ª–∏ null"
      inputs: {}
      expected_outputs: {}
      timeout: 300
      retry_policy:
        max_attempts: 3
        delay: 10
      dependencies: []
      approval_required: true|false
      risk_level: "low|medium|high"
  alternatives: []
  monitoring:
    checkpoints: []
    metrics_to_track: []
    alerts_conditions: []
```

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–ù–µ–¥–µ–ª—è 1)
- [ ] –°–æ–∑–¥–∞—Ç—å `planning_service.py`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–ª–∞–Ω–∞ —á–µ—Ä–µ–∑ LLM
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞–∑–±–∏–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–∞ —à–∞–≥–∏
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –≤ –ë–î

### –≠—Ç–∞–ø 2: API endpoints (–ù–µ–¥–µ–ª—è 1-2)
- [ ] –°–æ–∑–¥–∞—Ç—å `plans.py` routes
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 3: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ù–µ–¥–µ–ª—è 2)
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–ª–∞–Ω–æ–≤
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è (–ù–µ–¥–µ–ª—è 2-3)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç

**–í—ã—Å–æ–∫–∏–π** - —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø –ø–æ –ø–ª–∞–Ω—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–≠—Ç–∞–ø 2, –ø—É–Ω–∫—Ç 1)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- ‚úÖ –ú–æ–¥–µ–ª—å Plan –≤ –ë–î
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (–¥–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞–Ω–æ–≤)
- ‚úÖ Ollama –∫–ª–∏–µ–Ω—Ç (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–ª–∞–Ω–æ–≤)
- ‚è≥ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

