# ‚úÖ –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ - –ó–ê–í–ï–†–®–ï–ù–û

## üéâ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞/–º–æ–¥–µ–ª–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –∏ –º–æ–¥–µ–ª–∏ –±—Ä–∞–ª –¥–∞–Ω–Ω—ã–µ –∏–∑ `.env` –≤–º–µ—Å—Ç–æ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω API `chat.py` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `server_id` –∏–∑ –ë–î –≤–º–µ—Å—Ç–æ `server` (URL –∏–∑ .env)
- ‚úÖ Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `server_id` –≤–º–µ—Å—Ç–æ `server` URL
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ –ë–î —á–µ—Ä–µ–∑ `OllamaService.get_server_by_id()`
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ë–î —á–µ—Ä–µ–∑ `/api/servers/{server_id}/models`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/app/api/routes/chat.py`:
  - `server: Optional[str]` ‚Üí `server_id: Optional[str]`
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ –ë–î –ø–æ `server_id`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Depends(get_db)` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î

- `frontend/templates/main.html`:
  - Select —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `server.id` –≤–º–µ—Å—Ç–æ `server.url`
  - –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ `/api/servers/{server_id}/models`
  - Fallback –Ω–∞ `/api/models/servers` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### 2. –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏
**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `frontend/templates/main.html`

**–í–∫–ª–∞–¥–∫–∏:**
1. **üí¨ –ß–∞—Ç** - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞
2. **‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** - –æ—á–µ—Ä–µ–¥—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (iframe –Ω–∞ `/approvals`)
3. **üì¶ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** - —Å–ø–∏—Å–æ–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (iframe –Ω–∞ `/artifacts`)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ï–¥–∏–Ω—ã–π header —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º AARD
- –í–∫–ª–∞–¥–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏
- –ß–∞—Ç –≤—Å—Ç—Ä–æ–µ–Ω –Ω–∞–ø—Ä—è–º—É—é
- –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ iframe
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- `backend/app/api/routes/pages.py`:
  - –ò–∑–º–µ–Ω–µ–Ω —à–∞–±–ª–æ–Ω —Å `index_new.html` –Ω–∞ `main.html`

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```
–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (/)
‚îú‚îÄ‚îÄ –í–∫–ª–∞–¥–∫–∞ "–ß–∞—Ç"
‚îÇ   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ (–∏–∑ –ë–î)
‚îÇ   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ (–∏–∑ –ë–î)
‚îÇ   ‚îú‚îÄ‚îÄ –¢–∏–ø –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ Temperature
‚îÇ   ‚îî‚îÄ‚îÄ –ß–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ –í–∫–ª–∞–¥–∫–∞ "–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"
‚îÇ   ‚îî‚îÄ‚îÄ iframe ‚Üí /approvals
‚îî‚îÄ‚îÄ –í–∫–ª–∞–¥–∫–∞ "–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã"
    ‚îî‚îÄ‚îÄ iframe ‚Üí /artifacts
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### API –∏–∑–º–µ–Ω–µ–Ω–∏—è

**ChatMessage –º–æ–¥–µ–ª—å:**
```python
server_id: Optional[str] = Field(
    default=None,
    description="Ollama server ID from database (required when model is specified)"
)
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ server_id:**
```python
if chat_message.server_id and chat_message.server_id.strip():
    server = OllamaService.get_server_by_id(db, chat_message.server_id.strip())
    if server:
        selected_server_url = server.get_api_url()
```

### Frontend –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞:**
```javascript
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç server.id –≤–º–µ—Å—Ç–æ server.url
option.value = server.id;
```

**–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π:**
```javascript
// –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ API —Å–µ—Ä–≤–µ—Ä–æ–≤
const response = await fetch(`/api/servers/${selectedServerId}/models`);
```

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

**–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**
- ‚úÖ –í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞/–º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –ë–î
- ‚úÖ –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ —Å–æ–∑–¥–∞–Ω
- ‚úÖ –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000/`
2. –í—ã —É–≤–∏–¥–∏—Ç–µ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ç—Ä–µ–º—è –≤–∫–ª–∞–¥–∫–∞–º–∏
3. **–ß–∞—Ç** - –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å AI
4. **–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏
5. **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏

–í—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –∏ –º–æ–¥–µ–ª–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –ë–î, –∞ –Ω–µ —á–µ—Ä–µ–∑ `.env`!

