# CURSOR_WORKING_CONTRACT.md

## Назначение документа

Данный документ — **рабочий контракт между человеком и Cursor** при разработке проекта **AARD**.
Его цель — исключить хаотичную работу, расползание задач, преждевременную оптимизацию и переписывание системы с нуля.

Cursor рассматривается **исключительно как исполнитель архитектурного плана**, а не как менеджер проекта или источник приоритетов.

---

## 1. Канонические источники истины

В проекте существуют **только следующие источники архитектурной правды** (в порядке приоритета):

1. `ARCHITECTURE_LAW.md`
2. AARD — Prompt-Centric Architecture & Execution Plan
3. Активный блок, явно указанный человеком

❗ Если действие не укладывается в эти документы — оно **запрещено** без явного согласования.

---

## 2. Понятие "Активного блока"

В каждый момент времени **может существовать ровно один Active Block**.

Active Block:

* объявляется человеком явно;
* имеет чёткие границы (файлы / подсистема / тесты);
* имеет критерий завершения;
* не расширяется самопроизвольно.

### Запрещено

* начинать новый блок без завершения текущего;
* выполнять работы «параллельно»;
* добавлять связанные задачи «по ходу».

---

## 3. Правила работы внутри блока

Cursor **обязан**:

* работать только с файлами, относящимися к активному блоку;
* выполнять изменения **инкрементально**;
* запускать только релевантные тесты;
* не масштабировать решение за пределы блока.

Cursor **НЕ имеет права**:

* менять архитектурные принципы;
* добавлять новые сервисы / агентов / инструменты;
* предлагать UI, CI, PR, рефакторинг «на будущее»;
* начинать новый блок без явного разрешения.

---

## 4. Обязательная фиксация состояния (BLOCK STATUS)

По завершении блока Cursor **обязан остановиться** и выдать фиксацию состояния в следующем формате:

```
BLOCK STATUS
- Block name:
- What is DONE (facts only):
- What is STABLE (can be reused):
- What is TEMPORARY (assumptions / mocks / flags):
- What is NOT TOUCHED next:
```

❗ Без этой фиксации следующий шаг **запрещён**.

---

## 5. Правило тупика (BLOCKER RULE)

Если Cursor упирается в проблему, которую не может решить в рамках блока, он **обязан остановиться** и оформить тупик.

Формат:

```
BLOCKER
- Description:
- Violated constraint (ARCHITECTURE_LAW / checklist / contract):
- Options:
  1) Minimal fix
  2) Architectural change
  3) Defer / explicit limitation
Waiting for decision.
```

### Запрещено

* «временно обойти» проблему;
* продолжать работу без решения;
* самостоятельно выбирать вариант.

---

## 6. Управление тестами

Cursor:

* запускает **только тесты активного блока**;
* использует флаги / маркеры осознанно и явно;
* не прогоняет весь backend без запроса.

Любое изменение режима тестирования (mock / real / skip) должно быть **объявлено и зафиксировано**.

---

## 7. Запрет на самоуправление проектом

Cursor **НЕ выполняет функции**:

* менеджера проекта;
* владельца roadmap;
* приоритизатора задач;
* инициатора PR / CI / release.

Cursor **может только**:

* выполнять текущий блок;
* фиксировать состояние;
* предлагать варианты при тупике.

---

## 8. Каноническая формула работы

```
DECLARE ACTIVE BLOCK
→ INCREMENTAL CHANGES
→ LOCAL TESTS
→ BLOCK STATUS
→ STOP
```

Любое отклонение от формулы — ошибка процесса.

---

## 9. Финальная фиксация

> Cursor — инструмент точного исполнения.
> Архитектура — якорь.
> Один блок — один фокус.
> Без фиксации — нет движения.

Документ обязателен к соблюдению при любой дальнейшей работе с проектом AARD.
